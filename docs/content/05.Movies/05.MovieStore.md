# `useMovieStore` - Pinia Store Dokumentáció

Ez a dokumentum a `useMovieStore` Pinia Store-t írja le, amely a CinemaRoad projekt **frontend oldalán** a filmekkel kapcsolatos **adatok kezeléséért felelős**.

>Ez a Store a Vue Composition API-t és a Pinia könyvtárat használja, hogy **reaktív** *(kétirányú és dinamikus)* **állapotokat és aszinkron akciókat** biztosítson a backend **API-val** való kommunikációhoz.

A Store a Pinia `defineStore` függvényével jön létre, `movies` azonosítóval.

## Tartalomjegyzék

- [`useMovieStore` - Pinia Store Dokumentáció](#usemoviestore---pinia-store-dokumentáció)
  - [Tartalomjegyzék](#tartalomjegyzék)
  - [Függőségek](#függőségek)
  - [State - állapotok](#state---állapotok)
  - [Akciók](#akciók)
    - [`getMovies()`](#getmovies)
    - [`getMovie(id)`](#getmovieid)
    - [`createMovie(data)`](#createmoviedata)
    - [`updateMovie(id, data)`](#updatemovieid-data)
    - [`deleteMovie(id)`](#deletemovieid)

---

## Függőségek

*   `vue` (ref)
*   `pinia` (defineStore)
*   `@utils/http.mjs` (http kliens, axios alapokra építve.)

## State - állapotok

A Store a következő reaktív state változókat kezeli:

*   `movies`: Egy reaktív tömb, amely az összes film adatait tárolja. Kezdetben üres.
    *   **Típus:** `Array<Object>`

*   `movie`: Egy reaktív objektum, amely egyetlen film adatait tárolja. Kezdetben `null`.
    *   **Típus:** `Object | null`

## Akciók

Az alábbi aszinkron akciók felelősek a backend API-val való kommunikációért és a **Store** állapotának **frissítéséért**. Minden akció kezeli a lehetséges hibaeseteket.

### `getMovies()`

Lekéri az összes film adatait a backendről. Frissíti a `movies` state-et a kapott adatokkal.

*   **Végpont:** `GET /movies`

*   **Paraméterek:** Nincsenek

*   **Visszatérési érték:** `Promise<Array<Object>>` - Az összes film adatait tartalmazó tömb, vagy `undefined` hiba esetén.

*   **Hibakezelés:** Hiba esetén a konzolra logolja a hibát és elkapja azt, így a hívó félnek nem kell tovább kezelnie (de a függvény `undefined`-t ad vissza).


```javascript
async function getMovies() {
      try {
        const resp = await http.get("/movies");
        movies.value = resp.data.data;
        return movies.value;
      } catch (err) {
        console.error("Hiba a filmek lekérése közben", err);
      }
    }
```

### `getMovie(id)`

**Lekéri egy adott film adatait** azonosító (ID) alapján a backendről. Frissíti a `movie` state-et a kapott adatokkal.

*   **Végpont:** `GET /movies/:id`

*   **Paraméterek:**
    *   `id`: A lekérdezni kívánt film egyedi azonosítója.

*   **Visszatérési érték:** `Promise<Object>` - A film adatait tartalmazó objektum.

*   **Hibakezelés:** Hiba esetén a konzolra logolja a hibát és elkapja azt.

```javascript
async function getMovie(id) {
      try {
        const resp = await http.get(`/movies/${id}`);
        movie.value = resp.data.data;
        return movie.value;
      } catch (err) {
        console.error(`Hiba a film lekérése közben ${id}:`, err);
      }
    }
```

### `createMovie(data)`

**Új filmet hoz létre** a backend adatbázisában a megadott adatok alapján.

*   **Végpont:** `POST /movies`

*   **Paraméterek:**
    *   `data`: Egy objektum, amely a létrehozandó film adatait tartalmazza (pl. `title`, `description`, `duration_min`, `poster_url`).

*   **Visszatérési érték:** `Promise<Object>` - A létrehozott film adatait tartalmazó objektum.

*   **Hibakezelés:** Hiba esetén a konzolra logolja a hibát és *továbbdobja* a kivételt, így a hívó komponens kezelheti azt.

```javascript
async function createMovie(data) {
      try {
        const resp = await http.post("/movies", data);
        return resp.data.data;
      } catch (err) {
        console.error("Hiba az film létrehozásakor", err);
        throw err;
      }
    }
```


### `updateMovie(id, data)`

**Módosítja** egy létező film adatait az azonosítója (ID) és a frissített adatok alapján.

*   **Végpont:** `PUT /movies/:id`

*   **Paraméterek:**
    *   `id`: A módosítani kívánt film egyedi azonosítója.
    *   `data`: Egy objektum, amely a film frissített adatait tartalmazza.

*   **Visszatérési érték:** `Promise<Object>` - A módosított film adatait tartalmazó objektum.

*   **Hibakezelés:** Hiba esetén a konzolra logolja a hibát és *továbbdobja* a kivételt.

```js
async function updateMovie(id, data) {
    try {
      const resp = await http.put(`/movies/${id}`, data);
      return resp.data.data;
    } catch (err) {
      console.error("Hiba a film frissítésekor", err);
      throw err; 
    }
 }
```

### `deleteMovie(id)`

**Töröl** egy filmet a backend adatbázisából az azonosítója (ID) alapján. Sikeres törlés után frissíti a `movies` state-et is, eltávolítva belőle a törölt elemet.

*   **Végpont:** `DELETE /movies/:id`

*   **Paraméterek:**
    *   `id`: A törölni kívánt film egyedi azonosítója.

*   **Visszatérési érték:** `Promise<void>`

*   **Hibakezelés:** Hiba esetén a konzolra logolja a hibát és *továbbdobja* a kivételt.

```js
async function deleteMovie(id) {
  try {
    await http.delete(`/movies/${id}`);
    movies.value = movies.value.filter((m) => m.id !== id); 
  } catch (err) {
    console.error("Hiba a film törlésekor", err);
    throw err; 
  }
}
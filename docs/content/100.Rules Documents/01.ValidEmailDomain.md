
# Validation Rule Dokument√°ci√≥

## Felhaszn√°l√°si ter√ºletek √©s c√©l

### Mi√©rt van sz√ºks√©g DNS-alap√∫ email valid√°ci√≥ra?

A Laravel be√©p√≠tett `email` valid√°ci√≥s szab√°lya csak a **szintaktikai helyess√©get** ellen≈ërzi az **RFC** 5322 szabv√°ny alapj√°n. Ez azt jelenti, hogy olyan email c√≠mek is √°tmennek a valid√°ci√≥n, mint `test@nemletezodomain.xyz`, amennyiben szintaktikailag helyesek. Ennek tov√°bbfejleszt√©s√©re √©s a hat√©konys√°g√°nak n√∂vel√©se √©rdek√©ben **extra v√©delmet biztos√≠t** az egy√©ni **valid√°ci√≥s szab√°lyunk**.

### Gyakorlati alkalmaz√°si ter√ºletek:

- **Felhaszn√°l√≥i regisztr√°ci√≥**: Val√≥s email c√≠mek biztos√≠t√°sa
- **Newsletter feliratkoz√°s**: Bounced emailek minimaliz√°l√°sa
- **√úgyf√©lszolg√°lati rendszerek**: √ârv√©nyes kapcsolattart√°si adatok
- **E-commerce platformok**: Megb√≠zhat√≥ v√°s√°rl√≥i adatb√°zis √©p√≠t√©se
- **API v√©gpontok**: K√ºls≈ë integr√°ci√≥k sz√°m√°ra tiszta adatok

---

## üõ†Ô∏è Oszt√°ly le√≠r√°sa √©s implement√°ci√≥

### ValidEmailDomain Rule oszt√°ly

A `ValidEmailDomain` egy custom **validation rule**, amely a Laravel 10+ `ValidationRule` interface-t implement√°lja, √©s **DNS lookup** seg√≠ts√©g√©vel ellen≈ërzi az email domain val√≥dis√°g√°t.

```php
class ValidEmailDomain implements ValidationRule
{
    public function validate(string $attribute, mixed $value, Closure $fail): void
    {
        $domain = substr(strrchr($value, "@"), 1);
        if (!checkdnsrr($domain, 'MX') && !checkdnsrr($domain, 'A')) {
            $fail('Az email domain nem l√©tezik.');
        }
    }
}
```

### M≈±k√∂d√©si mechanizmus:

1. **Domain extrakci√≥**: Az `@` jel ut√°ni r√©sz kinyer√©se
2. **MX record ellen≈ërz√©s**: Mail server l√©tez√©s√©nek vizsg√°lata
3. **A record fallback**: Ha nincs MX, legal√°bb IP c√≠m l√©tezzen
4. **Error handling**: Sikertelen valid√°ci√≥ eset√©n magyar hiba√ºzenet

### DNS Record t√≠pusok magyar√°zata:

- **MX Record**: Mail Exchange - email szerverre mutat
- **A Record**: Address - IP c√≠mre oldja fel a domaint
- **Logika**: Ha van MX rekord ‚Üí email fogadhat√≥, ha nincs MX de van A ‚Üí basic web domain

---

## üìù FormRequest integr√°ci√≥

### RegisterUserRequest implement√°ci√≥

A validation rule-t a Laravel FormRequest oszt√°lyban haszn√°ljuk a tiszta k√≥d elveket k√∂vetve:

<?php

namespace App\Http\Requests;

use Illuminate\Foundation\Http\FormRequest;
use App\Rules\ValidEmailDomain;

class RegisterUserRequest extends FormRequest
{
    /**
     * Determine if the user is authorized to make this request.
     */
    public function authorize(): bool
    {
        return true; // Public regisztr√°ci√≥ enged√©lyez√©se
    }

    /**
     * Get the validation rules that apply to the request.
     */
    public function rules(): array
    {
        return [
            "name" => [
                "required",
                "string",
                "max:60",
                "min:6"
            ],
            "email" => [
                "required",
                "min:8",
                "max:50",
                new ValidEmailDomain(), // DNS-alap√∫ domain valid√°ci√≥
            ],
            "phone" => [
                "required", 
                "string",
                "max:50",
                "min:6",
            ],
            "password" => [
                "required",
                "string", 
                "min:8",
                "max:50",
                'regex:/^(?=.*[A-Z])(?=.*\d)(?=.*[\W_]).{8,50}$/' // Er≈ës jelsz√≥
            ],
        ];
    }
}

### Controller haszn√°lat:

<?php

namespace App\Http\Controllers;

use App\Http\Requests\RegisterUserRequest;

class RegisterController extends Controller
{
    public function register(RegisterUserRequest $request)
    {
        // A valid√°ci√≥ automatikusan lefut
        // Ha sikertelen ‚Üí 422 Unprocessable Entity
        // Ha sikeres ‚Üí folytat√≥dik a regisztr√°ci√≥
        
        $validatedData = $request->validated();
        
        // User l√©trehoz√°s logic...
    }
}

### El≈ëny√∂k a FormRequest haszn√°lattal:

- **Separation of Concerns**: Valid√°ci√≥ k√ºl√∂n oszt√°lyban
- **Reusability**: √öjrafelhaszn√°lhat√≥ m√°s v√©gpontokn√°l  
- **Automatic HTTP Response**: 422 status automatikus k√ºld√©se
- **Clean Controller**: Controller csak business logic-kal foglalkozik

---
## üìä √ñsszefoglal√°s √©s kulcspontok

### üéØ Mi√©rt fontos a ValidEmailDomain rule?

1. **Adatmin≈ës√©g jav√≠t√°sa**: Csak val√≥di email c√≠mek ker√ºlnek az adatb√°zisba
2. **K√∂lts√©ghat√©konys√°g**: Kevesebb bounced email, jobb delivery rate
3. **Felhaszn√°l√≥i √©lm√©ny**: Azonnali feedback hib√°s email eset√©n
4. **Compliance**: Adatv√©delmi el≈ë√≠r√°sok betart√°sa tiszta adatokkal

### üîß Technikai el≈ëny√∂k:

- **Laravel 10+ kompatibilis**: Modern ValidationRule interface
- **Performance optimized**: Gyors DNS lookup-ok
- **Error handling**: Magyar nyelv≈±, felhaszn√°l√≥bar√°t hiba√ºzenetek  
- **Extensible**: K√∂nnyen b≈ëv√≠thet≈ë tov√°bbi valid√°ci√≥s logik√°val
